# linux per_cpu（linux 6.10）

per-CPU 变量是 Linux 内核中一种特殊的数据结构，用于为每个 CPU 核心分配独立的变量实例。它的主要目的是避免多核环境下的锁竞争，提高性能。每个 CPU 核心访问自己的 per-CPU 变量时，不需要加锁，因为数据是独立的。

## 执行方法
1. make编译，加载模块insmod percpu_demo.ko

2. 执行dmesg -w，监控内核输出

3. 卸载模块rmmod percpu_demo


## per_cpu的作用

- 避免锁竞争：在多核系统中，多个 CPU 核心可能同时访问共享数据，通常需要使用锁来保护数据。使用 per-CPU 变量后，每个 CPU 核心都有自己的变量副本，无需加锁。

- 提高性能：减少了锁的开销，提高了并发性能。

- 适用于统计和缓存：常用于统计每个 CPU 的核心数据（如计数器）或缓存每个 CPU 的私有数据。